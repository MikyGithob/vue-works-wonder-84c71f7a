<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Presentation App</title>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    
    <!-- React Query -->
    <script src="https://unpkg.com/@tanstack/react-query@latest/build/umd/index.production.js"></script>

    <!-- Custom Styles -->
    <style>
        :root {
            --primary: #9b87f5;
            --secondary: #7E69AB;
            --tertiary: #6E59A5;
            --dark: #1A1F2C;
            --light: #D6BCFA;
        }

        .btn {
            @apply px-4 py-2 rounded-md transition-colors;
        }

        .btn-ghost {
            @apply hover:bg-opacity-10 hover:bg-white;
        }

        .card {
            @apply bg-white rounded-lg shadow-lg border border-gray-200 transition-all duration-300;
        }

        .card:hover {
            @apply shadow-xl transform -translate-y-1;
        }

        .dragging {
            @apply opacity-50 border-2 border-dashed border-primary cursor-grabbing;
        }

        .carousel-container {
            @apply relative overflow-hidden rounded-lg;
        }

        .carousel-slide {
            @apply flex transition-transform duration-300 ease-in-out;
        }

        .carousel-arrow {
            @apply absolute top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white p-3 rounded-full shadow-lg z-10 transition-all duration-300;
        }

        .carousel-arrow:hover {
            @apply scale-110;
        }

        .carousel-arrow.left {
            @apply left-4;
        }

        .carousel-arrow.right {
            @apply right-4;
        }

        .package-title {
            @apply text-2xl font-bold mb-4 cursor-pointer hover:text-primary transition-colors;
        }

        .add-item-btn {
            @apply flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-md hover:bg-opacity-90 transition-all duration-300;
        }

        .edit-input {
            @apply w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-primary to-tertiary min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const Toast = ({ message, onClose }) => {
            React.useEffect(() => {
                const timer = setTimeout(onClose, 3000);
                return () => clearTimeout(timer);
            }, [onClose]);

            return (
                <div className="fixed bottom-4 right-4 bg-primary text-white px-6 py-3 rounded-lg shadow-lg animate-fade-in">
                    <i className="fas fa-check-circle mr-2"></i>
                    {message}
                </div>
            );
        };

        const useToast = () => {
            const [toast, setToast] = React.useState(null);
            return {
                toast,
                showToast: (message) => setToast(message),
                hideToast: () => setToast(null)
            };
        };

        const QuestionPage = () => {
            const [answer, setAnswer] = React.useState(null);
            const [currentSlide, setCurrentSlide] = React.useState(0);
            
            const menuItems = [
                {
                    id: 1,
                    title: "Allergy-Safe Option",
                    points: ["Hypoallergenic", "Allergen-free", "Safe for sensitive users"],
                    price: 458.21,
                    description: "Specially designed for users with allergies and sensitivities."
                },
                {
                    id: 2,
                    title: "Standard Option",
                    points: ["Regular materials", "Standard formula", "Cost-effective"],
                    price: 534.50,
                    description: "Our standard option for users without specific allergies."
                }
            ];

            const handlePrevSlide = () => {
                setCurrentSlide(prev => Math.max(0, prev - 1));
            };

            const handleNextSlide = () => {
                setCurrentSlide(prev => Math.min(menuItems.length - 2, prev + 1));
            };

            return (
                <div className="p-8">
                    <div className="max-w-4xl mx-auto space-y-8">
                        <div className="bg-white p-8 rounded-lg shadow-lg">
                            <h2 className="text-3xl text-center mb-8 text-dark font-bold">
                                Does Anyone Suffer from Allergies?
                            </h2>
                            
                            <div className="flex justify-center gap-4 mb-8">
                                <button 
                                    className={`btn ${answer === "yes" ? 'bg-primary text-white' : 'bg-white border border-primary text-primary'}`}
                                    onClick={() => setAnswer("yes")}
                                >
                                    <i className="fas fa-check-circle mr-2"></i>
                                    Yes
                                </button>
                                <button 
                                    className={`btn ${answer === "no" ? 'bg-primary text-white' : 'bg-white border border-primary text-primary'}`}
                                    onClick={() => setAnswer("no")}
                                >
                                    <i className="fas fa-times-circle mr-2"></i>
                                    No
                                </button>
                            </div>

                            <div className="carousel-container">
                                <button 
                                    className="carousel-arrow left"
                                    onClick={handlePrevSlide}
                                    disabled={currentSlide === 0}
                                >
                                    <i className="fas fa-chevron-left"></i>
                                </button>
                                
                                <div className="carousel-slide" style={{
                                    transform: `translateX(-${currentSlide * 100}%)`
                                }}>
                                    <div className="grid grid-cols-2 gap-6 w-full">
                                        {menuItems.map((item) => (
                                            <div key={item.id} className="card p-6">
                                                <h3 className="text-xl font-bold mb-2">{item.title}</h3>
                                                <ul className="list-disc pl-5 mb-4">
                                                    {item.points.map((point, index) => (
                                                        <li key={index} className="text-gray-600">{point}</li>
                                                    ))}
                                                </ul>
                                                <p className="text-sm text-gray-600 mb-4">{item.description}</p>
                                                <div className="flex justify-between items-center">
                                                    <span className="text-xl font-bold text-primary">
                                                        ${item.price.toFixed(2)}
                                                    </span>
                                                    <button className="btn bg-primary text-white hover:bg-opacity-90">
                                                        <i className="fas fa-shopping-cart mr-2"></i>
                                                        Select
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <button 
                                    className="carousel-arrow right"
                                    onClick={handleNextSlide}
                                    disabled={currentSlide >= menuItems.length - 2}
                                >
                                    <i className="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const PackageItem = ({ pkg, onRemove, onUpdateTitle, isDraggable = true }) => {
            const [isEditing, setIsEditing] = React.useState(false);
            const [title, setTitle] = React.useState(pkg.title);
            const [isDragging, setIsDragging] = React.useState(false);

            const handleDragStart = (e) => {
                setIsDragging(true);
                e.dataTransfer.setData("application/json", JSON.stringify(pkg));
            };

            const handleTitleClick = () => {
                if (onUpdateTitle) {
                    setIsEditing(true);
                }
            };

            const handleTitleSubmit = () => {
                setIsEditing(false);
                if (title !== pkg.title && onUpdateTitle) {
                    onUpdateTitle(title);
                }
            };

            return (
                <div 
                    className={`card ${isDragging ? 'dragging' : ''}`}
                    draggable={isDraggable}
                    onDragStart={handleDragStart}
                    onDragEnd={() => setIsDragging(false)}
                >
                    <div className="p-6">
                        {onRemove && (
                            <button 
                                onClick={() => onRemove(pkg)}
                                className="absolute right-2 top-2 p-2 hover:bg-gray-100 rounded-full"
                            >
                                <i className="fas fa-times"></i>
                            </button>
                        )}
                        
                        {isEditing ? (
                            <input
                                value={title}
                                onChange={(e) => setTitle(e.target.value)}
                                onBlur={handleTitleSubmit}
                                onKeyDown={(e) => e.key === 'Enter' && handleTitleSubmit()}
                                className="edit-input"
                                autoFocus
                            />
                        ) : (
                            <h3 
                                className="package-title"
                                onClick={handleTitleClick}
                            >
                                {pkg.title}
                                {onUpdateTitle && (
                                    <i className="fas fa-edit ml-2 text-gray-400 hover:text-primary"></i>
                                )}
                            </h3>
                        )}
                        
                        <ul className="list-disc pl-5 mb-4 space-y-1">
                            {pkg.points.map((point, index) => (
                                <li key={index} className="text-gray-600">{point}</li>
                            ))}
                        </ul>
                        <p className="text-sm text-gray-600 mb-4">{pkg.description}</p>
                        <div className="flex justify-between items-center">
                            <span className="text-xl font-bold text-primary">
                                ${pkg.price.toFixed(2)}
                            </span>
                            <button className={`btn ${onRemove ? 'bg-gray-100' : 'bg-primary text-white'}`}>
                                {onRemove ? (
                                    <>
                                        <i className="fas fa-check mr-2"></i>
                                        Selected
                                    </>
                                ) : (
                                    <>
                                        <i className="fas fa-shopping-cart mr-2"></i>
                                        Select
                                    </>
                                )}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const PackageSection = ({ title, packages, showSelect, onRemoveItem, onDrop, onUpdateItem, onAddItem }) => {
            const handleDrop = (e) => {
                e.preventDefault();
                if (onDrop) {
                    onDrop(e);
                }
            };

            const handleDragOver = (e) => {
                e.preventDefault();
                e.currentTarget.classList.add('bg-primary/5');
            };

            const handleDragLeave = (e) => {
                e.currentTarget.classList.remove('bg-primary/5');
            };

            return (
                <div className="space-y-4 w-full max-w-md bg-white/10 backdrop-blur-sm p-6 rounded-lg">
                    <div className="flex justify-between items-center mb-4">
                        {showSelect && (
                            <select className="bg-white border border-gray-300 rounded-md px-3 py-2">
                                <option value="option1">{title} Option 1</option>
                                <option value="option2">{title} Option 2</option>
                            </select>
                        )}
                        
                        {onAddItem && (
                            <button onClick={onAddItem} className="add-item-btn">
                                <i className="fas fa-plus"></i>
                                Add Item
                            </button>
                        )}
                    </div>
                    
                    <div 
                        className="min-h-[400px] rounded-lg transition-all duration-300"
                        onDrop={handleDrop}
                        onDragOver={handleDragOver}
                        onDragLeave={handleDragLeave}
                    >
                        <div className="space-y-4 max-h-[calc(100vh-500px)] overflow-auto pr-4">
                            {packages.map((pkg) => (
                                <PackageItem
                                    key={pkg.id}
                                    pkg={pkg}
                                    onRemove={onRemoveItem}
                                    onUpdateTitle={(newTitle) => onUpdateItem(pkg, { ...pkg, title: newTitle })}
                                    isDraggable={true}
                                />
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [currentStep, setCurrentStep] = React.useState("presentation");
            const { toast, showToast, hideToast } = useToast();

            const renderStep = () => {
                switch (currentStep) {
                    case "presentation":
                        return <PresentationSlide />;
                    case "question":
                        return <QuestionPage />;
                    case "packages":
                        return <PackageSelection showToast={showToast} />;
                    default:
                        return null;
                }
            };

            const handleNext = () => {
                switch (currentStep) {
                    case "presentation":
                        setCurrentStep("question");
                        break;
                    case "question":
                        setCurrentStep("packages");
                        break;
                }
            };

            const handleBack = () => {
                switch (currentStep) {
                    case "question":
                        setCurrentStep("presentation");
                        break;
                    case "packages":
                        setCurrentStep("question");
                        break;
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-primary to-tertiary">
                    {renderStep()}
                    <div className="fixed bottom-8 right-8 flex gap-4">
                        {currentStep !== "presentation" && (
                            <button 
                                onClick={handleBack}
                                className="btn bg-white hover:bg-opacity-90"
                            >
                                <i className="fas fa-arrow-left mr-2"></i>
                                Back
                            </button>
                        )}
                        {currentStep !== "packages" && (
                            <button 
                                onClick={handleNext}
                                className="btn bg-white text-primary hover:bg-opacity-90"
                            >
                                Next
                                <i className="fas fa-arrow-right ml-2"></i>
                            </button>
                        )}
                    </div>
                    {toast && <Toast message={toast} onClose={hideToast} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>